Benchmarks
==========

All the network model have been evaluated on a couple of datasets (e.g. `Frappe <http://baltrunas.info/research-menu/frappe>`_, `iPinYou <http://data.computational-advertising.org/>`_, `Criteo <http://labs.criteo.com/2014/02/kaggle-display-advertising-challenge-dataset/>`_). We report logloss and AUC for evaluating model performance. Note that three of the best evaluation scores are marked with \* and **\`Setting\`** indicates (#Pool Size of LinkageEmbedding, #Embedding Dimention, Use BatchNormalization in LinkageEmbedding or not). 

.. contents::
   :local:
   :depth: 1


Criteo
------

For Criteo dataset, we use 3 fully-connected layers and each layer with 256 units in DeepFM; 6 cross layers and 2 fully-connected layers with 1024 units in DCN. As the data is organized chronologically, we randomly split the last 6,040,618 lines into validation and test set of equal size while the rest is taken as training data.


+------------------+-------------+-------------+----------------+------------+------------+
|**Embedding Type**| **Model**   |  **Setting**|**#Param(1e6)** | **Logloss**| **AUC**    |
+==================+=============+=============+================+============+============+
|                  | LR          |    \-       |       1        |   0.4635   |   79.05%   |
|                  +-------------+-------------+----------------+------------+------------+
|                  | FM          |    10       |       12       |   0.4558   |   79.96%   |
|                  +-------------+-------------+----------------+------------+------------+
|    Embedding     | Wide & Deep |    10       |       12       |   0.4507   |   80.52%   |
|                  +-------------+-------------+----------------+------------+------------+
|                  | DeepFM      |    10       |       12       |   0.4505   |   80.53%   |
|                  +-------------+-------------+----------------+------------+------------+
|                  | DCN         |    10       |       12       | **0.4487***| **80.69%***|
+------------------+-------------+-------------+----------------+------------+------------+
|                  | FM          |    3,10     |       4        |   0.4565   |   79.88%   |
|                  +-------------+-------------+----------------+------------+------------+
|                  | FM          |    4,10     |       5        |   0.4551   |   80.02%   |
|                  +-------------+-------------+----------------+------------+------------+
|                  | FM          |    5,10     |       6        |   0.4557   |   79.97%   |
|                  +-------------+-------------+----------------+------------+------------+
|                  | FM          |    6,10     |       8        |   0.4558   |   79.96%   |
|                  +-------------+-------------+----------------+------------+------------+
|                  | FM          |    7,10     |       9        |   0.4546   |   80.08%   |
|                  +-------------+-------------+----------------+------------+------------+
|                  | FM          |    8,10     |       10       |   0.4545   |   80.10%   |
|                  +-------------+-------------+----------------+------------+------------+
|                  | FM          |    9,10     |       11       |   0.4545   |   80.09%   |
|                  +-------------+-------------+----------------+------------+------------+
|                  | FM          |    10,10    |       12       |   0.4540   |   80.13%   |
|                  +-------------+-------------+----------------+------------+------------+
|                  | FM          |    10,50    |       12       |   0.4523   |   80.34%   |
|                  +-------------+-------------+----------------+------------+------------+
|                  | FM          |    10,100   |       12       |   0.4513   |   80.44%   |
|                  +-------------+-------------+----------------+------------+------------+
|                  | FM          |    10,200   |       12       |   0.4508   |   80.49%   |
| LinkageEmbedding +-------------+-------------+----------------+------------+------------+
|                  | FM          |    10,300   |       12       |   0.4508   |   80.50%   |
|                  +-------------+-------------+----------------+------------+------------+
|                  | FM          |    10,500   |       12       |   0.4500   |   80.57%   |
|                  +-------------+-------------+----------------+------------+------------+
|                  | FM          |    10,800   |       12       |   0.4505   |   80.51%   |
|                  +-------------+-------------+----------------+------------+------------+
|                  | FM          |    10,1000  |       12       |   0.4503   |   80.53%   |
|                  +-------------+-------------+----------------+------------+------------+
|                  | Wide & Deep |    10,10    |       12       |   0.4505   |   80.50%   |
|                  +-------------+-------------+----------------+------------+------------+
|                  | Wide & Deep |    10,100   |       13       | **0.4497***| **80.61%***|
|                  +-------------+-------------+----------------+------------+------------+
|                  | DeepFM      |    10,10    |       12       |   0.4501   |   80.57%   |
|                  +-------------+-------------+----------------+------------+------------+
|                  | DeepFM      |    10,10,BN |       12       |   0.4501   |   80.57%   |
|                  +-------------+-------------+----------------+------------+------------+
|                  | DeepFM      |    10,100   |       13       |   0.4499   |   80.57%   |
|                  +-------------+-------------+----------------+------------+------------+
|                  | DCN         |    10,10    |       12       | **0.4490***| **80.65%***|
|                  +-------------+-------------+----------------+------------+------------+
|                  | DCN         |    10,10,BN |       12       |   0.4554   |   79.99%   |
+------------------+-------------+-------------+----------------+------------+------------+

iPinYou
-------

For iPinYou dataset, we use the 3 layers DNN each with 256 units. In addition, the depth of cross layer in DCN is set to 4. We only use the impression and click logs of season 2, the first 6 days of which are taken as training data while the day 7 data is equally split into validation and test set.


+------------------+-------------+-------------+----------------+------------+------------+
|**Embedding Type**| **Model**   |  **Setting**|   **#Param**   | **Logloss**| **AUC**    |
+==================+=============+=============+================+============+============+
|                  | LR          |    \-       |    499,991     |   0.5832   |  81.98%    |
|                  +-------------+-------------+----------------+------------+------------+
|                  | FM          |    10       |   5,499,881    |   0.4454   |  90.31%    |
|                  +-------------+-------------+----------------+------------+------------+
|    Embedding     | Wide & Deep |    10       |   5,683,177    |   0.3603   |  93.60%    |
|                  +-------------+-------------+----------------+------------+------------+
|                  | DeepFM      |    10       |   5,683,177    | **0.3569***|  93.62%    |
|                  +-------------+-------------+----------------+------------+------------+
|                  | DCN         |    10       |   5,186,523    |   0.4783   |  87.87%    |
+------------------+-------------+-------------+----------------+------------+------------+
|                  | FM          |    5,10     |   3,000,908    |   0.3687   |  93.24%    |
|                  +-------------+-------------+----------------+------------+------------+
|                  | FM          |    10,10    |   5,501,487    |   0.3595   |  93.26%    |
|                  +-------------+-------------+----------------+------------+------------+
|                  | FM          |    10,10,BN |   5,501,835    |   0.4732   |  87.93%    |
|                  +-------------+-------------+----------------+------------+------------+
|                  | FM          |    10,30    |   5,504,967    |   0.3660   |  93.08%    |
|                  +-------------+-------------+----------------+------------+------------+
|                  | FM          |    10,50    |   5,508,447    |   0.3660   |  93.23%    |
|                  +-------------+-------------+----------------+------------+------------+
|                  | FM          |    10,100   |   5,517,147    |   0.3638   |  93.45%    |
|                  +-------------+-------------+----------------+------------+------------+
| LinkageEmbedding | Wide & Deep |    10,10    |   5,685,177    |   0.3613   |  93.62%    |
|                  +-------------+-------------+----------------+------------+------------+
|                  | Wide & Deep |    10,50    |   5,897,977    | **0.3552***|**94.03%*** |
|                  +-------------+-------------+----------------+------------+------------+
|                  | DeepFM      |    10,10    |   5,685,177    | **0.3575***|**93.87%*** |
|                  +-------------+-------------+----------------+------------+------------+
|                  | DeepFM      |    10,10,BN |   5,685,577    |   0.4341   |  90.58%    |
|                  +-------------+-------------+----------------+------------+------------+
|                  | DeepFM      |    10,50    |   5,897,977    |   0.3630   |**94.07%*** |
|                  +-------------+-------------+----------------+------------+------------+
|                  | DeepFM      |    10,100   |   6,163,977    |   0.3578   |  93.57%    |
|                  +-------------+-------------+----------------+------------+------------+
|                  | DCN         |    10,10    |   5,188,523    |   0.4839   |  86.26%    |
|                  +-------------+-------------+----------------+------------+------------+
|                  | DCN         |    10,10,BN |   5,188,923    |   0.4690   |  88.82%    |
+------------------+-------------+-------------+----------------+------------+------------+

Frappe
------

The `Frappe dataset <http://baltrunas.info/research-menu/frappe>`_ is a small dataset for quick experimentation and testing of different models. It has been used for context-aware app recommendation, which contains 96,203 app usage logs of users under different contexts. The eight context variables are all categorical, including weather, city, daytime and so on. After one-hot encoding of the features, we obtain 5,382 features. As all logs should be considered as positive sample when making CTR prediction, we construct two negative instances for each log through randomly replacing the item variable with other item. The data is randomly split into training data (70%), validation data (20%), test data (10%) before constructing negative instances. 

For Frappe dataset, we use the 3 layers DNN each with 256 units. In addition, the depth of cross layer in DCN is set to 1. 


+------------------+-------------+-------------+----------------+------------+------------+
|**Embedding Type**| **Model**   |  **Setting**|   **#Param**   | **Logloss**| **AUC**    |
+==================+=============+=============+================+============+============+
|                  | LR          |    \-       |     5,384      |   0.4173   |   87.51%   |
|                  +-------------+-------------+----------------+------------+------------+
|                  | FM          |    256      |   1,383,176    |   0.2595   |   95.98%   |
|                  +-------------+-------------+----------------+------------+------------+
|                  | NFM         |    256      |   1,580,808    |   0.2940   |   94.80%   |
|                  +-------------+-------------+----------------+------------+------------+
|                  | AFM         |    256      |   1,391,690    |   0.2752   |   95.66%   |
|                  +-------------+-------------+----------------+------------+------------+
|    Embedding     | FNN         |    256      |   2,165,249    |   0.2699   |   95.78%   |
|                  +-------------+-------------+----------------+------------+------------+
|                  | IPNN        |    256      |   2,176,769    | **0.2154***| **97.04%***|
|                  +-------------+-------------+----------------+------------+------------+
|                  | Wide & Deep |    256      |   2,170,632    |   0.2710   |   95.75%   |
|                  +-------------+-------------+----------------+------------+------------+
|                  | DeepFM      |    256      |   2,170,632    |   0.2762   |   95.75%   |
|                  +-------------+-------------+----------------+------------+------------+
|                  | DCN         |    F        |    407,823     |   0.3162   |   93.99%   |
+------------------+-------------+-------------+----------------+------------+------------+
|                  | FM          |min128,256   |    813,260     |   0.2721   |   95.96%   |
|                  +-------------+-------------+----------------+------------+------------+
|                  | FM          |min128,256,BN|    814,248     |   0.2354   |   96.22%   |
|                  +-------------+-------------+----------------+------------+------------+
|                  | FM          |min256,256   |   1,575,133    |   0.2468   |   96.42%   |
|                  +-------------+-------------+----------------+------------+------------+
|                  | FM          |min256,256,BN|   1,576,843    |   0.2240   |   96.43%   |
|                  +-------------+-------------+----------------+------------+------------+
|                  | FM          |min256,512   |   1,794,013    |   0.2490   |   96.44%   |
|                  +-------------+-------------+----------------+------------+------------+
|                  | FM          |min256,512,BN|   1,795,723    | **0.2174***|   96.59%   |
|                  +-------------+-------------+----------------+------------+------------+
|                  | NFM         |min256,256   |   1,772,765    |   0.2199   |   96.72%   |
|                  +-------------+-------------+----------------+------------+------------+
|                  | AFM         |min256,256   |   1,583,647    |   0.2968   |   94.83%   |
| LinkageEmbedding +-------------+-------------+----------------+------------+------------+
|                  | FNN         |min256,256   |   2,357,206    |   0.2369   |   96.21%   |
|                  +-------------+-------------+----------------+------------+------------+
|                  | IPNN        |min256,256   |   2,368,726    | **0.2141***| **97.06%***|
|                  +-------------+-------------+----------------+------------+------------+
|                  | Wide & Deep |min256,256   |   2,362,589    |   0.2314   |   96.62%   |
|                  +-------------+-------------+----------------+------------+------------+
|                  | DeepFM      |min256,256   |   2,362,589    |   0.2410   | **96.77%***|
|                  +-------------+-------------+----------------+------------+------------+
|                  | DeepFM      |min256,256,BN|   2,364,829    |   0.2378   |   96.53%   |
|                  +-------------+-------------+----------------+------------+------------+
|                  | DeepFM      |min256,512   |   3,236,829    |   0.2289   |   96.73%   |
|                  +-------------+-------------+----------------+------------+------------+
|                  | DCN         |minF,F       |    412,135     |   0.2536   |   95.72%   |
|                  +-------------+-------------+----------------+------------+------------+
|                  | DCN         |minF,F,BN    |    412,435     |   0.2573   |   95.64%   |
+------------------+-------------+-------------+----------------+------------+------------+

:minK:
  min(#category cardinality, K)
:F:
  6*(#category cardinality)^(1/4)

